CMAKE_MINIMUM_REQUIRED(VERSION 2.4.5 FATAL_ERROR)

PROJECT(osgPPU)

SET(CMAKE_MODULE_PATH "${osgPPU_SOURCE_DIR}/CMakeModules;${CMAKE_MODULE_PATH}")

# Dynamic vs Static Linking
OPTION(DYNAMIC_OSGPPU "Set to ON to build osgPPU for dynamic linking.  Use OFF for static." ON)
IF (DYNAMIC_OSGPPU)
    SET(OSGPPU_USER_DEFINED_DYNAMIC_OR_STATIC "SHARED")
ELSE (DYNAMIC_OSGPPU)
    SET(OSGPPU_USER_DEFINED_DYNAMIC_OR_STATIC "STATIC")
ENDIF(DYNAMIC_OSGPPU)

#######################################
# Library files
#######################################

FIND_PACKAGE(OpenGL)
FIND_PACKAGE(OSG)

INCLUDE_DIRECTORIES(
	${OPENGL_INCLUDE_DIR}
    ${OSG_INCLUDE_DIR}
	${osgPPU_SOURCE_DIR}/include 
)

SET(GL_LIBS 
  ${OPENGL_gl_LIBRARY} 
  ${OPENGL_glu_LIBRARY}
)

#######################################
# Solution definition
#######################################

IF(WIN32)
	ADD_DEFINITIONS(-D_USE_MATH_DEFINES)
    ADD_DEFINITIONS(-D_SCL_SECURE_NO_WARNINGS)
    ADD_DEFINITIONS(-D_CRT_SECURE_NO_DEPRECATE)

    IF(MSVC)
		OPTION(OSGPPU_MSVC_DEBUG_INCREMENTAL_LINK "Set to OFF to build without incremental linking in debug (release is off by default)" OFF)
		IF(NOT OSGPPU_MSVC_DEBUG_INCREMENTAL_LINK)
			SET(CMAKE_MODULE_LINKER_FLAGS_DEBUG "/debug /INCREMENTAL:NO")
			SET(CMAKE_SHARED_LINKER_FLAGS_DEBUG "/debug /INCREMENTAL:NO")
			SET(CMAKE_EXE_LINKER_FLAGS_DEBUG "/debug /INCREMENTAL:NO")
		ENDIF(NOT OSGPPU_MSVC_DEBUG_INCREMENTAL_LINK)
    ENDIF(MSVC)
ENDIF(WIN32)



#Solution
SET(EXECUTABLE_OUTPUT_PATH ${osgPPU_SOURCE_DIR}/bin)
SET(LIBRARY_OUTPUT_PATH ${osgPPU_SOURCE_DIR}/lib)
LINK_DIRECTORIES(${LIBRARY_OUTPUT_PATH})

INCLUDE(OsgPPUMacroUtils)

ADD_SUBDIRECTORY(src)

